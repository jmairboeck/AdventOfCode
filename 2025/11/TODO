Part 2 is still missing. The current solution is too inefficient and probably also wrong.
