This doesn't work efficiently (yet). Part 2 is therefore still missing.
